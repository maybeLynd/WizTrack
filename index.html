<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Respawn Acquisition Tracker</title>
  <style>
    :root {
      --bg: #f7f7f7;
      --text: #333;
      --card-bg: #fff;
      --border: #ddd;
      --header-bg: #333;
      --header-text: #fff;
      --th-bg: #f0f0f0;
      --th-text: #000;
      --btn-bg: #fafafa;
      --btn-border: #bbb;
      --btn-text: #000;
      --detail-text: #666;
      --link: #0077cc;
      --modal-bg: #fff;
      --overlay: rgba(0,0,0,0.6);
      --check-grey: #bbb;
      --check-green: #4caf50;
    }
    .dark-mode {
      --bg: #1a1a1a;
      --text: #eee;
      --card-bg: #2a2a2a;
      --border: #555;
      --header-bg: #444;
      --header-text: #ddd;
      --th-bg: #333;
      --th-text: #eee;
      --btn-bg: #444;
      --btn-border: #666;
      --btn-text: #eee;
      --detail-text: #aaa;
      --link: #66aaff;
      --modal-bg: #333;
      --overlay: rgba(0,0,0,0.8);
      --check-grey: #555;
    }

    html, body { height:100%; margin:0; background: transparent; color: var(--text); }
    body { display:flex; align-items:center; justify-content:center; padding:1rem; font-family:sans-serif; }
    .tracker-container {
      position: relative;
      background: var(--card-bg);
      border:1px solid var(--border);
      border-radius:8px;
      box-shadow:0 2px 8px rgba(0,0,0,0.1);
      padding:1rem 1.5rem;
      max-width:90vw; max-height:90vh;
      overflow-y:auto;
    }
    .toggle-container { position:absolute; top:0.5rem; right:0.5rem; font-size:0.85rem; }
    .toggle-container input { margin-right:0.3rem; }
    h1 { margin:0 0 .5rem; font-size:1.25rem; }
    p { margin:0 0 1rem; font-size:.95rem; }

    table { width:100%; border-collapse:collapse; }
    th, td {
      border:1px solid var(--border);
      padding:.3rem .6rem;
      vertical-align:top; font-size:.9rem; text-align:left;
      color: var(--text);
    }
    th {
      background: var(--th-bg);
      color: var(--th-text);
      font-weight:600;
    }
    .details { margin-top:.25rem; font-size:.8rem; color: var(--detail-text); padding-left:.6rem; }
    .entry-link { color: var(--link); text-decoration:none; cursor:pointer; }
    .entry-link:hover { text-decoration:underline; }

    .section-header td {
      background: var(--header-bg);
      color: var(--header-text);
      font-weight:bold; text-align:center; padding:.5rem;
    }
    .subsection-header td {
      background: var(--th-bg);
      color: var(--th-text);
      font-style: italic; text-align:left; padding:.4rem .6rem;
    }

    .checkmark {
      margin-right:.4rem; font-size:1.6rem; font-weight:900;
      color: var(--check-grey); line-height:1; vertical-align:middle;
    }
    tr.collected .checkmark { color: var(--check-green); }

    button {
      padding:.25rem .6rem; font-size:.85rem; cursor:pointer;
      border:1px solid var(--btn-border); border-radius:4px;
      background: var(--btn-bg); color: var(--btn-text);
    }
    button:hover { background: var(--th-bg); }

    .reset-btn {
      background:none; border:none; font-size:1.2rem;
      color: var(--detail-text); margin-left:.4rem;
      cursor:pointer; vertical-align:middle;
    }
    .reset-btn:hover { color: var(--check-grey); }

    #modal {
      display:none; position:fixed; top:0; left:0; width:100%; height:100%;
      background: var(--overlay); z-index:1000;
      align-items:center; justify-content:center;
    }
    #modal .modal-content {
  position: relative;
  background: var(--modal-bg);
  padding: 1rem;
  border-radius: 8px;
  /* cap size */
  max-width: 600px;
  width: 90%;
  max-height: 80vh;
  overflow: auto;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
  color: var(--text);
}

#modal img {
  /* keep image contained */
  max-width: 100%;
  max-height: 70vh;
  display: block;
  margin: 0 auto;
}

#modal .modal-close {
  position: absolute;
  top: .5rem;
  right: .75rem;
  font-size: 1.25rem;
  cursor: pointer;
  color: var(--text);
}

  </style>
</head>
<body>
  <div class="tracker-container">
    <div class="toggle-container">
      <label><input type="checkbox" id="dark-toggle">Dark Mode</label>
    </div>
    <h1>Respawn Acquisition Tracker</h1>
    <p>Click an entry name to view its location image (if one exists). <br>Click “Collect” to change the status to collected and add the timestamp<br>Click “Update” to change the collected timestamp to most current or undo collected status with “⟲”.</br></p></p>
    <table id="tracker">
      <thead><tr><th>Entry</th><th>Last Collected</th><th>Action</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <div id="modal">
    <div class="modal-content">
      <span class="modal-close">&times;</span>
      <h2 id="modal-title"></h2>
      <img id="modal-image" src="" alt="">
    </div>
  </div>

  <script>
  (function(){
    const SECTIONS = [
  {
    title: 'Mausoleum Reset',
    items: [
      { subheader: 'Ancient Mausoleum' },
      {
        id: 'cauldron_mausoleum',
        title: 'Crucible Mausoleum',
        details: 'Resets May 4 at 00:00',
        image: 'images/cauldron_mausoleum.png',
        clickable: false
      }
    ]
  },
  {
    title: 'Adventurer Remains',
    items: [
      { subheader: 'Beginning Abyss' },
      {
        id: 'b1f_awakened_chamber',
        title: 'Old Remains: Cursed Wheel to Awakening',
        details: 'Part of the Intro',
        image: 'images/b1f_awakened_chamber.png',
        clickable: false
      },
      {
        id: 'b1f_stench_quest',
        title: 'Class Remains: B1F (Death Stench Investigation Request)',
        details: 'Wheel to Fresh Start and get to the first harken then return and accept the Request',
        image: 'images/respawning-bone-death-stench.jpg',
        clickable: true
      },
      {
        id: 'b3f_goblin_south',
        title: 'Adventurers Remains: B3F (Goblin’s Nest)',
        details: 'Wheel to Kings Rescue and head to the location',
        image: 'images/respawning-bone-goblin-den.jpg',
        clickable: true
      },
      {
        id: 'b4f_rubble',
        title: 'Adventurers Remains: B4F',
        details: 'Assuming you wheeled to Kings Rescue already, head to the location',
        image: 'images/respawning-bone-b4f.jpg',
        clickable: true
      },
      {
        id: 'b5f_toxin_swamps',
        title: 'Adventurers Remains: B5F',
        details: 'Assuming you wheeled to Kings Rescue already, head to the location',
        image: 'images/respawning-bone-b5f.jpg',
        clickable: true
      },
      {
        id: 'b6f_before_statue',
        title: 'Adventurers Remains: B6F',
        details: 'Same as above, you need to come in from B5F to take the portals',
        image: 'images/respawning-bone-b6f.jpg',
        clickable: true
      },
      {
        id: 'b7f_rubble_reverse',
        title: 'Adventurers Remains: B7F',
        details: 'Same as below, you need to first drop the rocks on B8F',
        image: 'images/respawning-bone-b7f.jpg',
        clickable: true
      },
      {
        id: 'b8f_nutrient',
        title: 'Adventurers Remains: B8F',
        details: 'Assuming you wheeled to Kings Rescue already, head to the location',
        image: 'images/respawning-bone-b8f.jpg',
        clickable: true
      },
      { subheader: 'Trade Waterway' },
      {
        id: 'trade_waterway_pier',
        title: 'Adventurers Remains: 7th District (Shore of the Dead)',
        details: 'Not sure',
        image: 'images/trade_waterway_pier.png',
        clickable: false
      },
      { subheader: 'Impregnable Fortress' },
      {
        id: 'fortress_catacombs',
        title: 'Adventurers Remains: Catacombs',
        details: 'Not sure',
        image: 'images/fortress_catacombs.png',
        clickable: false
      }
    ]
  },
  {
    title: 'Equipment/Request Rewards',
    items: [
      { subheader: 'Beginning Abyss' },
      {
        id: 'abyss_b1f_feathered',
        title: 'Feathered Cap',
        details: 'Chest in B1F (x:11, y:21)',
        image: 'images/abyss_b1f_feathered.png',
        clickable: false
      },
      {
        id: 'abyss_b3f_exorcism',
        title: 'Exorcism Armor',
        details: 'Chest in B3F (x:0, y:3)',
        image: 'images/abyss_b3f_exorcism.png',
        clickable: false
      },
      {
        id: 'abyss_b4f_halberd',
        title: 'Halberd',
        details: 'Chest in B4F (x:2, y:13)',
        image: 'images/abyss_b4f_halberd.png',
        clickable: false
      },
      {
        id: 'abyss_b5f_huntsman',
        title: 'Huntsmans Bow',
        details: 'Chest in B5F (x:8, y:2)',
        image: 'images/abyss_b5f_huntsman.png',
        clickable: false
      },
      {
        id: 'abyss_b5f_breeze',
        title: 'Sword of the Breeze',
        details: 'Chest in B5F (x:8, y:3)',
        image: 'images/abyss_b5f_breeze.png',
        clickable: false
      },
      {
        id: 'abyss_b5f_resistance',
        title: 'Ring of Resistance',
        details: 'Chest in B5F (x:8, y:4)',
        image: 'images/abyss_b5f_resistance.png',
        clickable: false
      },
      {
        id: 'abyss_b8f_nutrient',
        title: 'Bracelet of Impurity',
        details: 'Chest in B8F (x:0, y:22)',
        image: 'images/abyss_b8f_nutrient.png',
        clickable: false
      },
      {
        id: 'digger_pickaxe',
        title: 'Bracelet of Urgency',
        details: 'Quest Reward from "Knight-Butcher Ent Proliferation"',
        image: 'images/digger_pickaxe.png',
        clickable: false
      },
      {
        id: 'digger_pickaxe',
        title: 'Plague Mask',
        details: 'Clear all waves in "March of the Undead" request',
        image: 'images/digger_pickaxe.png',
        clickable: false
      },
      {
        id: 'digger_pickaxe',
        title: 'Digging Mattock',
        details: 'Quest Reward from "Saving Lambert"',
        image: 'images/digger_pickaxe.png',
        clickable: false
      },
      {
        id: 'digger_pickaxe',
        title: 'Royal Herald Amulet',
        details: 'Quest Reward from "Save the King"',
        image: 'images/digger_pickaxe.png',
        clickable: false
      },
      {
        id: 'digger_pickaxe',
        title: 'Bracelet of Battle',
        details: 'Chance to drop from "The Greater Demon"',
        image: 'images/digger_pickaxe.png',
        clickable: false
      },
      { subheader: 'Trade Waterway' },
      {
        id: 'lightfoot_sandals',
        title: 'Light Sandals',
        details: 'Chest in 3rd District',
        image: 'images/lightfoot_sandals.png',
        clickable: false
      },
      {
        id: 'oktonaras_hidden',
        title: 'Thieves Gloves',
        details: 'Chest in 4th District',
        image: 'images/oktonaras_hidden.png',
        clickable: false
      },
      {
        id: 'oktonaras_hidden',
        title: 'Man-Eater',
        details: 'Chest in 5th District',
        image: 'images/oktonaras_hidden.png',
        clickable: false
      },
      {
        id: 'mask_water_deity',
        title: 'Mask of the Water God',
        details: 'Chest in 6th District',
        image: 'images/mask_water_deity.png',
        clickable: false
      },
      {
        id: 'lightfoot_sandals',
        title: 'Bird Dropper',
        details: 'Quest Reward from "Hydra Plant Procurement"',
        image: 'images/lightfoot_sandals.png',
        clickable: false
      },
      {
        id: 'oktonaras_hidden',
        title: 'Bloodstained Gloves',
        details: 'Quest Reward from "Servant and Cargo Recovery"',
        image: 'images/oktonaras_hidden.png',
        clickable: false
      },
      {
        id: 'sacred_grimoire',
        title: 'Melgina’s Choker',
        details: 'Defeat Octonarus after giving Melgina the Mackerel Sandwich',
        image: 'images/sacred_grimoire.png',
        clickable: false
      },
      {
        id: 'oktonaras_hidden',
        title: 'Shield of Honor',
        details: 'Quest Reward from "Missing Person (Princess Route)"',
        image: 'images/oktonaras_hidden.png',
        clickable: false
      },
      {
        id: 'oktonaras_hidden',
        title: 'Octonarus’s Necklace',
        details: 'Defeat Octonarus after giving Melgina the Titanium Knife',
        image: 'images/oktonaras_hidden.png',
        clickable: false
      },
      {
        id: 'brutal_cutlass',
        title: 'Cutlass of Tyranny',
        details: 'Choose "Octonarus‘s Cherished Sword" after defeating Octonarus',
        image: 'images/brutal_cutlass.png',
        clickable: false
      },
      {
        id: 'fortune_potion',
        title: 'Pearl of the Sea God',
        details: 'Quest Reward from "Arena Tournament by Avare"',
        image: 'images/fortune_potion.png',
        clickable: false
      },
      { subheader: 'Impregnable Fortress' },
      {
        id: 'oktonaras_hidden',
        title: 'Undead Ward',
        details: 'Quest Reward from "Abyssal Heretic"',
        image: 'images/oktonaras_hidden.png',
        clickable: false
      },
      {
        id: 'skull_necklace',
        title: 'Skull Necklace',
        details: 'Quest Reward from "Putting Evil Spirits to Rest" or Zone 2 Chest',
        image: 'images/skull_necklace.png',
        clickable: false
      },
      {
        id: 'enemy_scope',
        title: 'Enemy Spyglass',
        details: 'Quest Reward from "Bodyguard for Ruins Exploration"',
        image: 'images/enemy_scope.png',
        clickable: false
      },
      {
        id: 'demonic_crystal',
        title: 'Demonic Crystal',
        details: 'Fortress Underground » "Guardian of Forbidden Exploration" quest » "You Know Sin"',
        image: 'images/demonic_crystal.png',
        clickable: false
      },
      {
        id: 'goats_cloak',
        title: 'Goatskin Cloak',
        details: 'Quest Reward from "Antique Scarlet Doll" or Chest in Zone 6',
        image: 'images/goats_cloak.png',
        clickable: false
      },
      {
        id: 'knights_cloak',
        title: 'Knight’s Cloak',
        details: 'Quest Reward from "Expedition to Clear the Fortress Lower Levels"',
        image: 'images/knights_cloak.png',
        clickable: false
      },
      {
        id: 'glittering_ring',
        title: 'Shining Finger Band',
        details: 'Reward from beating Morgus, God of Death',
        image: 'images/glittering_ring.png',
        clickable: false
      },
      {
        id: 'elegant_dancer',
        title: 'Elegant Dancer',
        details: 'Admiral Route Clear Reward',
        image: 'images/elegant_dancer.png',
        clickable: false
      },
      {
        id: 'tome_shieldbearer',
        title: 'Tome of the Loyal Shieldbearer',
        details: 'Princess Route Clear Reward',
        image: 'images/tome_shieldbearer.png',
        clickable: false
      },
      {
        id: 'holy_white_gem',
        title: 'Luminous Holy White Gem',
        details: 'Papal Route Clear Reward',
        image: 'images/holy_white_gem.png',
        clickable: false
      },
      {
        id: 'soul_potion_d9',
        title: 'Soul Potion',
        details: 'District 9',
        image: 'images/soul_potion_d9.png',
        clickable: false
      },
      {
        id: 'embroidered_hankerchief',
        title: 'Golden Embroidered Handkerchief',
        details: 'Quest Reward from Cleanup Operation quest reward',
        image: 'images/embroidered_hankerchief.png',
        clickable: false
      },
      {
        id: 'everlasting_lily',
        title: 'Everlasting Lily',
        details: 'Quest Reward from "Requiem for the Evil Spirit" quest',
        image: 'images/everlasting_lily.png',
        clickable: false
      }
    ]
  }
];


    const STORAGE_KEY = 'respawn_acquisition_data';
    const data = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
    const tbody = document.querySelector('#tracker tbody');
    const modal = document.getElementById('modal');
    const modalImg = document.getElementById('modal-image');
    const modalTitle = document.getElementById('modal-title');
    const modalClose = modal.querySelector('.modal-close');
    const darkToggle = document.getElementById('dark-toggle');

    function formatDate(ts) {
      return ts ? new Date(ts).toLocaleString() : '-';
    }
    function save() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    }

    function render() {
      let html = '';
      SECTIONS.forEach(section => {
        html += `<tr class="section-header"><td colspan="3">${section.title}</td></tr>`;
        section.items.forEach(item => {
          if (item.subheader) {
            html += `<tr class="subsection-header"><td colspan="3">${item.subheader}</td></tr>`;
            return;
          }
          const collected = Boolean(data[item.id]);
          const check = `<span class="checkmark">✓</span>`;
          const clickable = item.clickable !== false && item.image;
          const nameEl = clickable
            ? `<a href="#" class="entry-link" data-image="${item.image}" data-title="${item.title}">${item.title}</a>`
            : `<span>${item.title}</span>`;

          const actionBtn = `<button class="action-btn">${collected ? 'Update' : 'Collect'}</button>`;
          const resetBtn = collected
            ? `<button class="reset-btn" title="Undo collection">⟲</button>`
            : '';

          html += `
            <tr data-id="${item.id}" class="${collected?'collected':''}">
              <td>${check}${nameEl}${item.details?`<div class="details">${item.details}</div>`:''}</td>
              <td class="ts">${formatDate(data[item.id])}</td>
              <td>${actionBtn}${resetBtn}</td>
            </tr>`;
        });
      });
      tbody.innerHTML = html;

      tbody.querySelectorAll('.action-btn').forEach(btn => {
        btn.addEventListener('click', e => {
          const row = e.target.closest('tr');
          const id = row.dataset.id;
          data[id] = Date.now(); save(); render();
        });
      });
      tbody.querySelectorAll('.reset-btn').forEach(btn => {
        btn.addEventListener('click', e => {
          const row = e.target.closest('tr');
          const id = row.dataset.id;
          delete data[id]; save(); render();
        });
      });
      tbody.querySelectorAll('.entry-link').forEach(link => {
        link.addEventListener('click', e => {
          e.preventDefault();
          modalImg.src = link.dataset.image;
          modalTitle.textContent = link.dataset.title;
          modal.style.display = 'flex';
        });
      });
    }

    modalClose.addEventListener('click', () => modal.style.display = 'none');
    modal.addEventListener('click', e => { if (e.target===modal) modal.style.display = 'none'; });
    darkToggle.addEventListener('change', () => document.body.classList.toggle('dark-mode', darkToggle.checked));

    render();
  })();
  </script>
</body>
</html>
